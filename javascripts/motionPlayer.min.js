/*! eyeplayer - v0.0.0 - 2014-01-21
* Copyright (c) 2014 Author Name; Licensed MIT */
define("blendDifference",[],function(){return function(a,b,c){function d(a){return a>21?255:0}function e(a){return(a^a>>31)-(a>>31)}function f(a,b,c){if(b.length!==c.length)return null;for(var f=0;f<.25*b.length;){var g=(b[4*f]+b[4*f+1]+b[4*f+2])/3,h=(c[4*f]+c[4*f+1]+c[4*f+2])/3,i=d(e(g-h));a[4*f]=i,a[4*f+1]=i,a[4*f+2]=i,a[4*f+3]=255,++f}return!0}var g=a.data,h=b.data,i=c.data;return f(g,h,i)?(a.data=g,!0):!1}}),define("motionDetector",["blendDifference"],function(a){return function(){var b,c,d=document.createElement("canvas"),e=d.getContext("2d");this.regions=function(){for(var a,c=[0,0,0,0,0,0,0,0],d=b.height/5,e=b.width/8,f=b.data,g=0;g<f.length;g+=4){var h=Math.floor(g/4/b.width);if(h>=d)break;var i=g/4%b.width;a=Math.floor(i/e),c[a]+=(f[g]+f[g+1]+f[g+2])/3}for(a=0;8>a;a++)c[a]/=d*e,c[a]<10&&(c[a]=-1);return c},this.tick=function(f,g){var h=f.width||f.videoWidth,i=f.height||f.videoHeight;h&&i&&(d.width=h,d.height=i),e.clearRect(0,0,d.width,d.height),b=e.getImageData(0,0,d.width,d.height),e.drawImage(f,0,0,d.width,d.height);var j=e.getImageData(0,0,d.width,d.height);return c||(c=j),a(b,j,c),c=j,g&&g(b),e.putImageData(b,0,0),d}}}),define("motionPlayer",["motionDetector"],function(a){return function(b){function c(){var a={video:!0},b=function(a){alert("Video capture error: ",a.code)};navigator.getUserMedia?navigator.getUserMedia(a,function(a){e.src=a,e.play()},b):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(a,function(a){e.src=window.webkitURL.createObjectURL(a),e.play()},b):navigator.mozGetUserMedia&&navigator.mozGetUserMedia(a,function(a){e.src=window.URL.createObjectURL(a),e.play()},b)}function d(){var a=h.tick(e,i),b=h.regions(),c=document.createEvent("Event");c.initEvent("motionEvent",!0,!0),c.image=a,c.regions=b,document.dispatchEvent(c),window.requestAnimFrame(d)}b||(b={});var e,f,g,h,i;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),this.setFilter=function(a){i=a},this.init=function(b,c){e=b,f=c,g=f.getContext("2d"),h=new a,e.addEventListener("playing",this.resize,!1)},this.resize=function(){var a=e.offsetWidth,b=e.videoHeight/e.videoWidth*a;f.width=a,f.height=b},this.start=function(){c(),window.setTimeout(d,1e3)}}}),require.config({paths:{}}),window.requireTestMode||require(["motionPlayer"],function(){}),define("config2",function(){});