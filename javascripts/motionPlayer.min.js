/*! eyeplayer - v0.0.0 - 2014-01-23
* Copyright (c) 2014 Author Name; Licensed MIT */
define("blendDifference",[],function(){return function(a,b,c){function d(a){return a>21?255:0}function e(a){return(a^a>>31)-(a>>31)}function f(a,b,c){if(b.length!==c.length)return null;for(var f=0;f<.25*b.length;){var g=(b[4*f]+b[4*f+1]+b[4*f+2])/3,h=(c[4*f]+c[4*f+1]+c[4*f+2])/3,i=d(e(g-h));a[4*f]=i,a[4*f+1]=i,a[4*f+2]=i,a[4*f+3]=255,++f}return!0}var g=a.data,h=b.data,i=c.data;return f(g,h,i)?(a.data=g,!0):!1}}),define("motionDetector",["blendDifference"],function(a){return function(b){b||(b={}),b.scale||(b.scale=1);var c,d,e=document.createElement("canvas"),f=e.getContext("2d");this.regions=function(){for(var a,b=[0,0,0,0,0,0,0,0],d=c.height/5,e=c.width/8,f=c.data,g=0;g<f.length;g+=4){var h=Math.floor(g/4/c.width);if(h>=d)break;var i=g/4%c.width;a=Math.floor(i/e),b[a]+=(f[g]+f[g+1]+f[g+2])/3}for(a=0;8>a;a++)b[a]/=d*e,b[a]<10&&(b[a]=-1);return b},this.tick=function(g){var h=Math.floor((g.width||g.videoWidth||640)*b.scale),i=Math.floor((g.height||g.videoHeight||380)*b.scale);h&&i&&e.width!==h&&e.height!==i&&(e.width=h,e.height=i),f.clearRect(0,0,e.width,e.height),c=f.getImageData(0,0,e.width,e.height);try{f.drawImage(g,0,0,e.width,e.height)}catch(j){return c}var k=f.getImageData(0,0,e.width,e.height);return d||(d=k),a(c,k,d),d=k,b.filter&&b.filter(c),f.putImageData(c,0,0),e}}}),define("motionPlayer",["motionDetector"],function(a){return function(b){function c(){var a={video:!0},b=function(a){alert("Video capture error: ",a.code)};navigator.getUserMedia?navigator.getUserMedia(a,function(a){f.src=a,f.play()},b):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(a,function(a){f.src=window.webkitURL.createObjectURL(a),f.play()},b):navigator.mozGetUserMedia&&navigator.mozGetUserMedia(a,function(a){f.src=window.URL.createObjectURL(a),f.play()},b)}function d(){if(f.videoWidth&&f.videoHeight){var a=f.offsetWidth,b=f.offsetHeight/f.offsetWidth*f.offsetWidth;g.width=a,g.height=b,e()}else window.setTimeout(d,.1)}function e(){var a=i.tick(f),b=i.regions(),c=document.createEvent("Event");c.initEvent("motionEvent",!0,!0),c.image=a,c.regions=b,document.dispatchEvent(c),window.requestAnimFrame(e)}b||(b={});var f,g,h,i;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),this.init=function(c,e){f=c,g=e,h=g.getContext("2d"),i=new a(b),f.addEventListener("playing",d,!1)},this.start=function(){c()}}}),require.config({paths:{}}),window.requireTestMode||require(["motionPlayer"],function(){}),define("config2",function(){});